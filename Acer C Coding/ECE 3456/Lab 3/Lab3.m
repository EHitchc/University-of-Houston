clc; clear workspace; close all;

%% NMOS

% Vgs = 0[v]

x = [0
0.51
1.09
1.59
2.08
2.48
2.96
3.49
4
4.55
5.03];
y = [0
0
0
0
0
0
0
0
0
0
0];

figure
plot(x,y, 'y-');
title('NMOS i-v characteristics');
xlabel('Vds [V]');
ylabel('Id [mA]');

grid on; hold on;

% Vgs = 0.5[v]

x = [0
0.5
1
1.48
2.03
2.56
2.99
3.44
4.04
4.52
5.11];
y = [0
0
0
0
0
0
0
0
0
0
0];

plot(x,y, 'm-');

% Vgs = 1[v]

x = [0
0.49
1.09
1.64
2.01
2.64
3.1
3.56
4.02
4.51
4.98];
y = [0
0.001
0.0011
0.0011
0.0011
0.0011
0.0011
0.0011
0.0011
0.0011
0.0011];

plot(x,y, 'c-');

% Vgs = 1.5[v]

x = [0
0.5
1.03
1.47
1.98
2.47
3.1
3.65
4.05
4.54
5.11];
y = [0.0026
0.0861
0.0882
0.0891
0.0898
0.0906
0.0913
0.0919
0.0923
0.0927
0.0932];

plot(x,y, 'r-');

% Vgs = 2[v]

x = [0
0.48
1.02
1.58
2.07
2.48
3.07
3.63
4.09
4.53
4.92];
y = [0.0066
0.3781
0.4031
0.4095
0.4133
0.416
0.419
0.4216
0.4235
0.4251
0.4265];

plot(x,y, 'g-');

% Vgs = 2.5[v]

x = [0
0.46
1.09
1.53
2.09
2.59
3.09
3.58
4.06
4.55
5.05];
y = [0.0094
0.7257
0.91
0.9265
0.9383
0.9456
0.9515
0.9564
0.9607
0.9649
0.9687];

plot(x,y, 'b-');
% Vgs = 3[v]

x = [0
0.54
1.05
1.57
2.05
2.51
3.05
3.48
4.03
4.47
5.08];
y = [0.0123
1.1308
1.5297
1.604
1.6266
1.6402
1.6523
1.6602
1.669
1.6751
1.6829];

plot(x,y, 'k-');

% Vgs = 3.5[v]

x = [0
0.55
1.01
1.5
1.99
2.58
3.01
3.58
4.03
4.57
5.01];
y = [0.0142
1.457
2.0986
2.3515
2.416
2.449
2.4648
2.4808
2.4915
2.5022
2.5101];

plot(x,y, 'g--');

% Vgs = 4[v]

x = [0
0.49
1.02
1.59
2.05
2.51
3.03
3.51
4.04
4.52
4.99];
y = [0.0165
1.5504
2.6471
3.1959
3.3268
3.3792
3.4115
3.4322
3.4504
3.4637
3.4752];

plot(x,y, 'm--');

% Vgs = 4.5[v]

x = [0
0.58
1.02
1.57
2.09
2.51
3.06
3.58
4.06
4.49
5.13];
y = [0.0181
2.0178
3.0908
3.9378
4.2673
4.361
4.419
4.4515
4.4735
4.4884
4.5085];

plot(x,y, 'c--');

% Vgs = 5[v]

x = [0
0.53
1.07
1.48
2.09
2.49
3.09
3.64
4.04
4.51
4.99];
y = [0.015
2.043
3.6003
4.449
5.1728
5.3674
5.4843
5.5355
5.56
5.5832
5.6018];

plot(x,y, 'r--');

% Load Line
% Vdd = 5;
% R = 10000;
% 
% x = [0
% Vdd];
% y = [(Vdd/R)*1000
% 0];
% 
% plot(x,y, 'b');

Vdd = 5;
Vt = 1.32;
K = 635.2 * 10^(-6);

x1 = [0 1.32];
x2 = [1.33 : 0.01 : 5];
y = (0.5.*(K.*((0-Vdd)+Vt).^2)).*1000;
y1 = [y y];
y2 = (K.*(((0-Vdd+Vt).*(x2-Vdd))-(0.5.*(x2-Vdd).^2))).*1000;
x = [x1 x2];
y = [y1 y2];

plot(x,y, 'b');
%% PMOS

% Vgs = 0[v]

x = 5-[0
0.49
1.06
1.56
2.01
2.51
3.01
3.51
4.11
4.54
5.06];
y = [0
0
0
0
0
0
0
0
0
0
0];

plot(x,y, 'y-');
title('PMOS i-v characteristics');
xlabel('Vds [V]');
ylabel('Id [mA]');

grid on; hold on;

% Vgs = 0.5[v]

x = 5-[0
0.48
1.08
1.5
2.13
2.45
2.98
3.51
4.17
4.49
5.05];
y = [0
0
0
0
0
0
0
0
0
0
0];

plot(x,y, 'm-');

% Vgs = 1[v]

x = 5-[0
0.45
1.14
1.47
2.04
2.47
3.18
3.47
4.08
4.52
5.05];
y = [0
0
0
0
0
0
0
0
0
0
0];

plot(x,y, 'c-');

% Vgs = 1.5[v]

x = 5-[0
0.54
1.01
1.55
2.1
2.47
3.01
3.5
4.02
4.52
5.12];
y = [0.0003
0.0056
0.006
0.0066
0.0071
0.0075
0.0079
0.0084
0.0089
0.0094
0.0099];

plot(x,y, 'r-');

% Vgs = 2[v]

x = 5-[0
0.53
1.07
1.66
2.08
2.47
3.03
3.53
4.09
4.56
5.03];
y = [0.0022
0.126
0.1407
0.151
0.1573
0.1627
0.1702
0.1765
0.1833
0.189
0.1946];

plot(x,y, 'g-');

% Vgs = 2.5[v]

x = 5-[0
0.55
1.09
1.49
2.1
2.51
2.97
3.5
4.07
4.48
5.09];
y = [0.0039
0.337
0.4385
0.4649
0.4936
0.5106
0.528
0.5465
0.5653
0.5785
0.5972];

plot(x,y, 'b-');
% Vgs = 3[v]

x = 5-[0
0.5
1.08
1.56
2.01
2.48
3.08
3.53
4.01
4.47
4.99];
y = [0.0054
0.4948
0.8004
0.901
0.9496
0.9885
1.031
1.0602
1.0896
1.1155
1.1446];

plot(x,y, 'k-');

% Vgs = 3.5[v]

x = 5-[0
0.47
1.01
1.52
1.98
2.49
2.97
3.53
3.98
4.57
5.1];
y = [0.0067
0.6173
1.094
1.3621
1.4906
1.5696
1.628
1.6858
1.7284
1.7803
1.8236];

plot(x,y, 'g--');

% Vgs = 4[v]

x = 5-[0
0.58
1.05
1.52
2.15
2.5
2.95
3.5
4.02
4.41
4.99];
y = [0.0079
0.8979
1.4301
1.8176
2.1315
2.231
2.322
2.4092
2.4799
2.5296
2.5976];

plot(x,y, 'm--');

% Vgs = 4.5[v]

x = 5-[0
0.6
0.99
1.58
2.03
2.49
2.99
3.44
4
4.52
4.91];
y = [0.009
1.0813
1.6286
2.283
2.6475
2.8977
3.0734
3.1826
3.2918
3.38
3.44];

plot(x,y, 'c--');

% Vgs = 5[v]

x = 5-[0
0.63
1.11
1.51
1.97
2.48
2.96
3.5
4.06
4.54
5.1];
y = [0.01
1.2702
2.0499
2.6003
3.1212
3.553
3.8348
4.0465
4.1992
4.3087
4.4191];

plot(x,y, 'r--');

%% Task B - Calculated
x = [0 .91 1.914 2.1 2.3 2.6065 3.68 5];
y = [5 5 4.659 4.404 0.980 0.351 0 0];
figure 
plot(x,y, 'b');
title('CMOS Inverter');
xlabel('Vin [V]');
ylabel('Vout [V]');

grid on;

%% Task B - Measured
x = [0	0.11	0.19	0.3	0.41	0.5	0.6	0.7	0.8	0.9	1.01	1.2	1.29	1.4	1.5	1.6	1.71	1.8	1.9	2.01	2.1	2.2	2.3	2.4	2.5	2.61	2.7	2.8	2.9	3	3.1	3.2	3.3	3.4	3.5	3.6	3.7	3.8	3.9	4	4.1	4.2	4.3	4.4	4.5	4.6	4.7	4.8	4.9	5];
y = [5.053	5.053	5.053	5.053	5.053	5.053	5.053	5.053	5.053	5.052	5.049	5.042	5.031	5.007	4.973	4.927	4.862	4.788	4.685	4.512	4.266	2.814	0.5498	0.3374	0.2441	0.1773	0.1366	0.1007	0.0688	0.0483	0.0306	0.0169	0.0086	0.0027	0.0005	0.0001	0	0	0	0	0	0	0	0	0	0	0	0	0	0];

figure
plot(x,y, 'b-');
title('CMOS Inverter');
xlabel('Vin [V]');
ylabel('Vout [V]');

grid on;

%% Task C - Calculated
x = [0 .91 3.366 4.598 5];
y = [5 5 3.972 2.296 1.956];
figure 
plot(x,y, 'b');
title('Pseudo-NMOS Inverter');
xlabel('Vin [V]');
ylabel('Vout [V]');

grid on;

%% Task C - Measured
x = [0	0.1	0.2	0.3	0.4	0.5	0.6	0.7	0.8	0.9	1	1.1	1.2	1.31	1.4	1.5	1.6	1.7	1.8	1.9	2	2.1	2.2	2.3	2.4	2.5	2.6	2.7	2.8	2.9	3	3.1	3.2	3.3	3.4	3.5	3.6	3.7	3.8	3.9	4	4.1	4.2	4.3	4.4	4.5	4.6	4.7	4.8	4.9	5];
y = [5.052	5.052	5.052	5.052	5.052	5.052	5.052	5.052	5.052	5.052	5.052	5.051	5.047	5.039	5.027	5.008	4.987	4.956	4.919	4.88	4.831	4.781	4.72	4.653	4.587	4.509	4.424	4.333	4.23	4.123	4.006	3.881	3.74	3.59	3.428	3.249	3.024	2.792	2.485	2.147	1.793	1.57	1.424	1.324	1.248	1.187	1.134	1.089	1.055	1.023	0.9922];

figure
plot(x,y, 'b-');
title('Pseudo-NMOS Inverter');
xlabel('Vin [V]');
ylabel('Vout [V]');

grid on;